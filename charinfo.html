<!doctype html>
<html>
	<head> 
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		
		<link href="css/bootstrap.css" rel="stylesheet" type="text/css" /> 
		<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" /> 
		
		<script src="js/jquery.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>

		<script src="jquery.js"></script> 


		<style>
			thead {
				background-color: palegoldenrod;
				padding: 25px 25px 25px 25px;
			}
			tbody {
				background-color: #2B1507;
				font-weight: bold;
				color:white
			}
			nav {
				color: black;
			}
			#rosterheader {
				font-weight: bold;
			}
			#userdata {
				border-collapse: collapse;
			}
			a{
				text-decoration: none;
				outline: 0;
			}
			a:active{
				text-decoration: none;
				outline: 0;
			}
			a:link{
				text-decoration: none;
				outline: 0;
			}
			a:hover{
				text-decoration: none;
				outline: 0;
				color: black;
			}
			table{
				font-family: Calibri;
			}
		</style> 
	</head>

	<body>
		<div id="kme"></div>
		
		<!-- Header iz header.html filea-->
		<div id="includedContent"></div>

		<div class="clusterize">
		  <table id= "userdata" style="width:100%" cellspacing="0" cellpadding="0">
				<thead>
			    <tr id="rosterheader">
			     <td>Name</td>
			      <td>Level</td>
			      <td>Ilvl</td>	
			      <td>Race</td>
			      <td>Class</td>
			      <td>Specialization</td>
			      <td>Rank</td>
			      <td style="width:12%">Achievement Points</td>
			    </tr>
			  </thead>
		    <tbody id="contentArea" class="clusterize-content">
		    	<!-- Ovdje ide ispis membera iz JSON-a-->
					<div id="scrollArea"></div>
		    </tbody>
		  </table>
		</div>

		<!-- js libs -->
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
		<script src="js/jquery.js"></script> 
		<script src="js/bootstrap.js"></script> 
		<script src="js/bootstrap.min.js"></script> 



		<!-- js scripts -->
		<script>
		var unsortedTable = [];
		
	    $(document).ready(function(){
				$.getJSON('https://eu.api.battle.net/wow/guild/Silvermoon/Rohnin?fields=members&locale=en_GB&apikey=zxu9j4nyhqhvdd2mc725g2urvfsm4qdp', function(data) {
					var counter=0;
			    $.each(data.members, function(i, f) {
				  	var armoryLink = "<a id=ime href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
				  	var klasa = f.character.class;
					switch(klasa){
						  case 1:
						  	klasa =  "<img src=images/icons_classes/warrior.jpg>";
								armoryLink="<a style=color:#C79C6E href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 2:
						  	klasa = "<img src=images/icons_classes/paladin.jpg>";
								armoryLink="<a style=color:#F58CBA href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 3:
						  	klasa = "<img src=images/icons_classes/hunter.jpg>";
								armoryLink="<a style=color:#ABD473 href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 4:
						  	klasa = "<img src=images/icons_classes/rogue.jpg>";
								armoryLink="<a style=color:#FFF569 href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 5:
						  	klasa = "<img src=images/icons_classes/priest.jpg>";
								armoryLink="<a style=color:#FFFFFF href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 6:
						  	klasa = "<img src=images/icons_classes/deathknight.jpg>";
								armoryLink="<a style=color:#C41F3B href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 7:
						  	klasa = "<img src=images/icons_classes/shaman.jpg>";
								armoryLink="<a style=color:#0070DE href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 8:
						  	klasa = "<img src=images/icons_classes/mage.jpg>";
								armoryLink="<a style=color:#40C7EB href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 9:
						  	klasa = "<img src=images/icons_classes/warlock.jpg>";
								armoryLink="<a style=color:#8787ED href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 10:
						  	klasa = "<img src=images/icons_classes/monk.jpg>";
								armoryLink="<a style=color:#00FF96 href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 11:
						  	klasa = "<img src=images/icons_classes/druid.jpg>";
								armoryLink="<a style=color:#FF7D0A href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  case 12:
								klasa = "<img src=images/icons_classes/demonhunter.jpg>";
								armoryLink="<a style=color:#A330C9 href=https://worldofwarcraft.com/en-gb/character/silvermoon/" + f.character.name + ">" + f.character.name +  "</a>";
						  break;
						  default:
							  klasa = "Unknown";
						  break;
				  	}

				  	var rasa = f.character.race;
					switch(rasa){
						  case 1:
								if(f.character.gender==0){
							  	rasa =  "<img src=images/icons_races/human_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/human_f.jpg>";
								}	
						  break;
						  case 2:
								if(f.character.gender==0){
							  		rasa =  "<img src=images/icons_races/orc_m.jpg>";
									}
								else {
									rasa =  "<img src=images/icons_races/orc_f.jpg>";
								}	
						  break;
						  case 3:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/dwarf_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/dwarf_f.jpg>";
								}
						  break;
						  case 4:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/nightelf_m.jpg>";
								}
								else {
										rasa =  "<img src=images/icons_races/nightelf_f.jpg>";
								}	
						  break;
						  case 5:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/undead_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/undead_f.jpg>";
								}	
						  break;
						  case 6:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/tauren_m.jpg>";
								}			  		
								else{
									rasa =  "<img src=images/icons_races/tauren_f.jpg>";
								} 
						  break;
						  case 7:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/gnome_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/gnome_f.jpg>";
								}
						  break;
						  case 8:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/troll_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/troll_f.jpg>";
								}
						  break;
						  case 9:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/goblin_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/goblin_f.jpg>";
								}
						  break;
						  case 10:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/bloodelf_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/bloodelf_f.jpg>";
								}				
						  break;
						  case 11:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/draenei_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/draenei_f.jpg>";
								}
						 	break;
						  case 22:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/worgen_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/worgen_f.jpg>";
								}
						  break;
						  case 24:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/pandaren_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/pandaren_f.jpg>";
								}
						  break;
						  case 25:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/pandaren_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/pandaren_f.jpg>";
								}
						  break;
						  case 27:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/nightborne_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/nightborne_f.jpg>";
								}
						  break;
						  case 28:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/hm_tauren_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/hm_tauren_f.jpg>";
								}
						  break;
						  case 29:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/voidelf_m.jpg>";
								}
								else{
									rasa =  "<img src=images/icons_races/voidelf_f.jpg>";
								} 
						  break;
						  case 30:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/lf_draenei_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/lf_draenei_f.jpg>";
								}
						  break;
						  case 34:
								if(f.character.gender==0){
									rasa =  "<img src=images/icons_races/didwarf_m.jpg>";
								}
								else {
									rasa =  "<img src=images/icons_races/didwarf_f.jpg>";
								}
						  break;
						  default:
							  rasa = "Unknown";
						  break;
						}
					
					if (f.character.spec !== undefined) {
						var spec = f.character.spec.name;	
					}
					else{
						var spec = "-";
					}
					
					// Dobavljanje Ilvla
					var ilvlURL = "https://eu.api.battle.net/wow/character/silvermoon/" + f.character.name + "?fields=items&locale=en_GB&apikey=zxu9j4nyhqhvdd2mc725g2urvfsm4qdp";
					
					$.getJSON(ilvlURL, function(data_ilvl){
						var itemLevel = data_ilvl.items.averageItemLevel;
						if(f.character.level < 120){
							itemLevel = 0;
						}
						
						
						if(counter==0){
							unsortedTable.push([armoryLink, f.character.level, itemLevel, rasa, klasa, spec, f.rank, f.character.achievementPoints]);
							counter++;
						}
						else{
							for(i=0;i<unsortedTable.length;i++){
								if(itemLevel >= unsortedTable[i][2]){
									unsortedTable.splice(i,0, [armoryLink, f.character.level, itemLevel, rasa, klasa, spec, f.rank, f.character.achievementPoints]);
									counter++;
									break;
								}
							}
						}
						
						if(counter == data.members.length-1){
							for(i=0; i<counter; i++){
								// Ispis u tbody
								var tblRow = "<tr>" + 
									"<td>" + unsortedTable[i][0] + "</td>" +
									"<td>" + unsortedTable[i][1] + "</td>" +
									"<td>" + unsortedTable[i][2] + "</td>" +
									"<td>" + unsortedTable[i][3] + "</td>" +
									"<td>" + unsortedTable[i][4] + "</td>" +
									"<td>" + unsortedTable[i][5] + "</td>" + 
									"<td>" + unsortedTable[i][6] + "</td>" + 
									"<td>" + unsortedTable[i][7] + "</td>" + 
								"</tr>";
			    				$(tblRow).appendTo("#userdata tbody");
							}
						}
								
					});
				});
			  });
		});
			
		</script>
 		<script> 
			$(function(){
			  $("#includedContent").load("header.html"); 
			});
		</script>  
	</body>
</html>
